"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.extend=extend,exports.merge=merge,exports.hyphenedToCamelCase=hyphenedToCamelCase,exports.camelCaseToHyphened=camelCaseToHyphened,exports.getNameByPath=getNameByPath,exports.getFileNameWithHash=getFileNameWithHash,exports.isEmptyObject=isEmptyObject,exports.isPlainObject=isPlainObject,exports.loadBabelModule=loadBabelModule,exports.getFilenameByPath=getFilenameByPath,exports.serialize=serialize,exports.sortFilesBy=sortFilesBy,exports.makeRequireString=makeRequireString,exports.stringifyLoaders=stringifyLoaders,exports.generateMap=generateMap,exports.consumeMap=consumeMap,exports.splitSourceLine=splitSourceLine,exports.print=print,exports.splitAttr=splitAttr,exports.isValidValue=isValidValue,exports.equals=equals,exports.resolvePath=resolvePath,exports.fileExists=fileExists,exports.getWebpackOptions=getWebpackOptions,exports.isUXRender=isUXRender,exports.isUXEntry=isUXEntry,exports.convertPath=convertPath,exports.lsdirdeep=lsdirdeep,exports.loaderWrapper=loaderWrapper,Object.defineProperty(exports,"colorconsole",{enumerable:!0,get:function(){return _sharedUtils.colorconsole}}),Object.defineProperty(exports,"logWarn",{enumerable:!0,get:function(){return _sharedUtils.logWarn}}),Object.defineProperty(exports,"mkdirsSync",{enumerable:!0,get:function(){return _sharedUtils.mkdirsSync}}),Object.defineProperty(exports,"KnownError",{enumerable:!0,get:function(){return _sharedUtils.KnownError}}),exports.FRAG_TYPE=exports.ENTRY_TYPE=void 0;var _path=_interopRequireDefault(require("path")),_fs=_interopRequireDefault(require("fs")),_loaderUtils=_interopRequireDefault(require("loader-utils")),_hashSum=_interopRequireDefault(require("hash-sum")),_sourceMap=require("source-map"),_config=_interopRequireDefault(require("@hap-toolkit/shared-utils/config")),_sharedUtils=require("@hap-toolkit/shared-utils");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function extend(e,...t){if("function"==typeof Object.assign)Object.assign(e,...t);else{const r=t.shift();for(const t in r)e[t]=r[t];t.length&&extend(e,...t)}return e}function merge(e,...t){return t.length&&t.forEach(t=>{e=e.concat(t)}),e}function hyphenedToCamelCase(e){return e.replace(/-([a-z])/g,(function(e,t){return t.toUpperCase()}))}function camelCaseToHyphened(e){return e.replace(/([A-Z])/g,(function(e,t){return"-"+t.toLowerCase()}))}function getNameByPath(e){return _path.default.basename(e).replace(/\..*$/,"")}function getFileNameWithHash(e,t){const r=_path.default.relative(".",e);return`./${r}?${(0,_hashSum.default)(r+t)}`}function isEmptyObject(e){if(!e)return!0;for(const t in e)return!1;return!0}const toString=Object.prototype.toString,OBJECT_STRING="[object Object]";function isPlainObject(e){return toString.call(e)===OBJECT_STRING}function loadBabelModule(e){const t=_path.default.resolve(__dirname,"..","node_modules",e),r=_path.default.resolve(_config.default.projectPath,"node_modules",e);return _fs.default.existsSync(t)?t:_fs.default.existsSync(r)?r:e}function getFilenameByPath(e){return _path.default.relative(".",e)}function serialize(e,t){const r=typeof e;if("undefined"===r)return e;if("function"===r)return e.toString();const n=[];let o=-1,i=`__FKS_${Math.random().toString(16).slice(2,10)}_FKE__`;const s=JSON.stringify(e,(e,t)=>"function"==typeof t?"":t);for(;s.indexOf(i)>-1;)i=`_${i}_`;let a=JSON.stringify(e,(function(e,t){return"function"==typeof t?(n.push(t),o++,i+o):t}),t);const u=new RegExp(`"${i}(\\d+)"`,"g");return a=a.replace(u,(e,t)=>n[t].toString()),a}function predicate(e){return"string"==typeof e?e===this.toString():this.match(e)}function sortFilesBy(e,t){const r=e.length;return e=e.sort((e,n)=>{let o=t.findIndex(predicate,e),i=t.findIndex(predicate,n);return o=-1===o?r:o,i=-1===i?r:i,o-i})}function makeRequireString(e,t,r){return print({loader:t,filepath:r}),"require("+_loaderUtils.default.stringifyRequest(e,t?`!!${t}!${r}`:`${r}`)+")\n"}function stringifyLoaders(e){return e.map(e=>{if("string"==typeof e)return e;{const t=e.name,r=[];if(e.query)for(const t in e.query){const n=e.query[t];null!=n&&(!0===n?r.push(t):n instanceof Array?r.push(`${t}[]=${n.join(",")}`):r.push(`${t}=${n}`))}return`${t}${r.length?"?"+r.join("&"):""}`}}).join("!")}function generateMap(e,t,r){const n=getFileNameWithHash(e.resourcePath),o=_path.default.resolve("."),i=new _sourceMap.SourceMapGenerator({sourceRoot:o,skipValidation:!0});i.setSourceContent(n,t);for(const{original:e,generated:t}of r)i.addMapping({source:n,original:e,generated:t});return i}function consumeMap(e,t,r){const n=new _sourceMap.SourceMapConsumer(r);let o;const i=[],s=[],a={};return splitSourceLine(t).forEach((e,t)=>{t+=1;const r=n.originalPositionFor({line:t,column:0});r.source&&(o=r.source,i.push({line:r.line,column:r.column}),s.push({line:t,column:0}),a[`line-${t}-column-0`]={line:r.line,column:r.column})}),{source:o,original:i,generated:s,mapping:a,sourcesContent:n.sourcesContent}}const REGEXP_LINE=/\r?\n/g;function splitSourceLine(e){return e.split(REGEXP_LINE)}const showLog=!1;function print(e){if(showLog){let t="";if("string"==typeof e)t="######### "+e+" #########";else for(const r in e)t+="######### "+r+" : "+e[r]+" #########\n";console.log(t)}}function splitAttr(e,t){const r=[];if(t)switch(e.forEach((e,t)=>{r[t]={},r[t].n=e}),t.length){case 1:e.forEach((e,n)=>{r[n].v=t[0]});break;case 2:e.forEach((e,n)=>{r[n].v=n%2?t[1]:t[0]});break;case 3:e.forEach((e,n)=>{r[n].v=n%2?t[1]:t[n]});break;default:e.forEach((e,n)=>{r[n].v=t[n]})}return r}function isValidValue(e){return"number"==typeof e||"string"==typeof e}function equals(e,t,r,...n){if(r){if(r(e,t,...n))return!0}const o=Object.prototype.toString.call(e);if(o!==Object.prototype.toString.call(t))return!1;if("[object Null]"===o||"[object Undefined]"===o)return!0;if("[object Object]"!==o&&"[object Array]"!==o)return Object(e).toString()===Object(t).toString();const i={};Object.keys(e).forEach(e=>i[e]=!0),Object.keys(t).forEach(e=>i[e]=!0);const s=Object.keys(i);for(let n=0;n<s.length;n++){const o=s[n];if(!equals(e[o],t[o],r,o))return!1}return!0}function resolvePath(e,t){if(t&&!_path.default.isAbsolute(e)){const r=_path.default.join(_path.default.dirname(t),e),n=_path.default.relative(_path.default.resolve(_config.default.projectPath,"./src"),r);e=_path.default.join("/",n).replace(/\\/g,"/")}return e}function fileExists(e,t){let r;if(_path.default.isAbsolute(e)){const t=_config.default.projectPath;r=_path.default.join(t,"./src",e)}else r=_path.default.resolve(t,"../",e);return _fs.default.existsSync(r)}function getWebpackOptions(e){return e.options||{}}function isUXRender(e){return e===ENTRY_TYPE.PAGE||e===ENTRY_TYPE.CARD}function isUXEntry(e){return e===ENTRY_TYPE.PAGE||e===ENTRY_TYPE.APP||e===ENTRY_TYPE.CARD}function convertPath(e){let t=_path.default.join(_config.default.projectPath,"src");return/^[/\\]node_modules/.test(e)&&(t=_config.default.projectPath),_path.default.join(t,e)}function lsdirdeep(e,t=_fs.default){return function e(t,r,n){let o=[];const i=_path.default.posix.join(t,r);return n.readdirSync(i).forEach(s=>{const a=_path.default.posix.join(i,s),u=_path.default.posix.join(r,s);n.statSync(a).isFile()?o.push(u):o=o.concat(e(t,u,n))}),o}(e,".",t)}function loaderWrapper(e,t){Array.isArray(t.use)||(t.use=[t.use]),t.use.unshift({loader:require.resolve("../loader/module-loader")}),t.use.push({loader:require.resolve("../loader/manifest-loader"),options:{path:e}})}const ENTRY_TYPE={APP:"app",PAGE:"page",COMP:"comp",CARD:"card",JS:"js"};exports.ENTRY_TYPE=ENTRY_TYPE;const FRAG_TYPE={IMPORT:"import",TEMPLATE:"template",STYLE:"style",SCRIPT:"script"};exports.FRAG_TYPE=FRAG_TYPE;
//# sourceMappingURL=utils.js.map
